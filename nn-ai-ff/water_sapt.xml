<ForceField>
  <!-- SAPT-FF force field for water, note this uses a dummy interaction site labeled 'M'   -->
  <!-- electrostatics is consistent with the SWM4-NDP model, hence the atom type names      -->
 <AtomTypes>
  <Type name="swm4ndp-O" class="OW" element="O" mass="0"/>
  <Type name="swm4ndp-H" class="HW" element="H" mass="0"/>
  <Type name="swm4ndp-M" class="MW" mass="0"/>
  <Type name="swm4ndp-OD" class="OWD" mass="0"/>
 </AtomTypes>
 <Residues>
  <Residue name="HOH">
   <Atom name="O" type="swm4ndp-O"/>
   <Atom name="H1" type="swm4ndp-H"/>
   <Atom name="H2" type="swm4ndp-H"/>
   <Atom name="M" type="swm4ndp-M"/>
   <Atom name="OD" type="swm4ndp-OD"/>
   <VirtualSite type="average3" index="3" atom1="0" atom2="1" atom3="2" weight1="0.589781071" weight2="0.2051094645" weight3="0.2051094645"/>
   <Bond from="0" to="1"/>
   <Bond from="0" to="2"/>
  </Residue>
 </Residues>
 <NonbondedForce coulomb14scale="0" lj14scale="0">
<!--  this would be the LJ potential for SWM4-NDP, which we don't use               -->
<!--  <Atom type="swm4ndp-O" charge="1.71636" sigma="0.318395" epsilon="0.882573"/> -->
  <Atom type="swm4ndp-O" charge="1.71636" sigma="1" epsilon="0"/>
  <Atom type="swm4ndp-H" charge="0.55733" sigma="1" epsilon="0"/>
  <Atom type="swm4ndp-M" charge="-1.11466" sigma="1" epsilon="0"/>
  <Atom type="swm4ndp-OD" charge="-1.71636" sigma="1" epsilon="0"/>
 </NonbondedForce>
 <DrudeForce>
  <Particle type1="swm4ndp-OD" type2="swm4ndp-O" charge="-1.71636" polarizability="0.000978253" thole="1.3"/>
 </DrudeForce>
 <CustomNonbondedForce energy="A*exBr - f6*C6/(r^6) - f8*C8/(r^8) - f10*C10/(r^10) - f12*C12/(r^12);
    A=Aex-Ael-Ain-Adh;
    Aex=sqrt(Aexch1*Aexch2); Ael=sqrt(Aelec1*Aelec2); Ain=sqrt(Aind1*Aind2); Adh=sqrt(Adhf1*Adhf2);
    f12 = f10 - exBr*( (1/39916800)*(Br^11)*(1 + Br/12) );
    f10 = f8 - exBr*( (1/362880)*(Br^9)*(1 + Br/10 ) );
    f8 = f6 - exBr*( (1/5040)*(Br^7)*(1 + Br/8 ) );
    f6 = 1 - exBr*(1 + Br * (1 + (1/2)*Br*(1 + (1/3)*Br*(1 + (1/4)*Br*(1 + (1/5)*Br*(1 + (1/6)*Br ) ) )  ) ) );
    exBr = exp(-Br);
    Br = B*r;
    B=(Bexp1+Bexp2)*Bexp1*Bexp2/(Bexp1^2 + Bexp2^2);
    C6=sqrt(C61*C62); C8=sqrt(C81*C82); C10=sqrt(C101*C102); C12=sqrt(C121*C122)"
    bondCutoff="3">
  <PerParticleParameter name="Aexch"/>
  <PerParticleParameter name="Aelec"/>
  <PerParticleParameter name="Aind"/>
  <PerParticleParameter name="Adhf"/>
  <PerParticleParameter name="Bexp"/>
  <PerParticleParameter name="C6"/>
  <PerParticleParameter name="C8"/>
  <PerParticleParameter name="C10"/>
  <PerParticleParameter name="C12"/>
  <Atom type="swm4ndp-O" Aexch="154905" Aelec="77452" Aind="21529" Adhf="0.0" Bexp="36.84974" C6="0.000456" C8="3.67376E-05" C10="2.87553E-06" C12="1.81911E-07"/>
  <Atom type="swm4ndp-H" Aexch="1575" Aelec="0.0" Aind="0.0" Adhf="0.0" Bexp="58.582" C6="2.6E-06" C8="1.3198E-07" C10="1.87942E-08" C12="1.30988E-09"/>
  <Atom type="swm4ndp-M" Aexch="55923" Aelec="13653" Aind="893" Adhf="788" Bexp="32.12541" C6="0.000841" C8="3.8005E-05" C10="1.76105E-06" C12="6.50111E-08"/>
  <Atom type="swm4ndp-OD" Aexch="0" Aelec="0" Aind="0" Adhf="0" Bexp="1" C6="0" C8="0" C10="0" C12="0"/>
 </CustomNonbondedForce>
</ForceField>
